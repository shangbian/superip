# 项目总览

## 📁 完整文件结构

```
羊智能体/
│
├── backend/                          # 后端服务目录
│   ├── src/                         # 源代码
│   │   ├── server.ts               # 服务器入口文件
│   │   ├── routes/                 # 路由模块
│   │   │   └── cozeRoutes.ts      # Coze API路由
│   │   ├── services/               # 业务逻辑层
│   │   │   └── cozeService.ts     # Coze服务封装
│   │   └── utils/                  # 工具函数
│   │       └── logger.ts          # 日志工具
│   ├── package.json                # 项目依赖配置
│   ├── tsconfig.json               # TypeScript配置
│   └── config.txt                  # 配置模板（需重命名为.env）
│
├── frontend/                         # 前端页面目录
│   ├── index.html                  # 主页面
│   └── app.js                      # 前端逻辑
│
├── logs/                            # 日志目录（自动生成）
│   ├── info.log                    # 信息日志
│   ├── error.log                   # 错误日志
│   ├── warn.log                    # 警告日志
│   └── debug.log                   # 调试日志
│
├── README.md                        # 项目说明文档
├── 快速启动指南.md                   # 快速启动说明
├── 项目总览.md                      # 本文件
├── 启动后端.bat                     # 后端启动脚本
├── 启动前端.bat                     # 前端启动脚本
├── .gitignore                      # Git忽略配置
│
├── Coze工作流完整建设指南.md         # 原始参考文档
├── 配置示例.md                      # 配置参考文档
├── 调用扣子API通用方法总结.md        # API调用方法总结
├── 各智能体介绍 .txt                # 智能体数据来源
└── 一站式社会化获客AI助手.html       # 旧版单文件（已废弃）
```

## 🔧 核心文件说明

### 后端文件

#### `backend/src/server.ts`
- **作用**：Express服务器主入口
- **功能**：
  - 配置CORS跨域
  - 注册路由
  - 错误处理
  - 健康检查接口

#### `backend/src/routes/cozeRoutes.ts`
- **作用**：API路由定义
- **接口**：
  - `POST /api/coze/workflow/execute` - 执行工作流
  - `GET /api/coze/test` - 测试连接

#### `backend/src/services/cozeService.ts`
- **作用**：Coze API调用核心逻辑
- **功能**：
  - 封装axios请求
  - 处理请求/响应拦截
  - 解析API响应数据
  - 错误处理

#### `backend/src/utils/logger.ts`
- **作用**：日志记录工具
- **功能**：
  - 记录不同级别日志
  - 输出到文件和控制台
  - 日志格式化

### 前端文件

#### `frontend/index.html`
- **作用**：前端页面结构和样式
- **功能**：
  - 响应式布局
  - 分类展示界面
  - 输入表单
  - 结果展示区
  - Markdown渲染

#### `frontend/app.js`
- **作用**：前端业务逻辑
- **功能**：
  - 36个智能体数据定义
  - API调用逻辑
  - 页面交互控制
  - 结果渲染和复制

### 配置文件

#### `backend/.env`（由config.txt重命名）
```env
COZE_TOKEN=你的Token
COZE_WORKFLOW_ID=7599232922009583626
PORT=3000
NODE_ENV=development
CORS_ORIGIN=http://localhost:8080
```

#### `backend/package.json`
- 定义项目依赖
- 定义npm脚本命令

#### `backend/tsconfig.json`
- TypeScript编译配置

## 🔄 数据流程

```
用户操作
   ↓
前端(frontend/app.js)
   ↓ HTTP POST
后端路由(cozeRoutes.ts)
   ↓
Coze服务(cozeService.ts)
   ↓ HTTPS
扣子API平台
   ↓ 响应
解析数据(cozeService.ts)
   ↓ JSON
返回前端
   ↓
Markdown渲染(marked.js)
   ↓
展示结果
```

## 📊 智能体数据结构

```javascript
{
    id: 1,                      // 智能体编号（对应choice参数）
    name: '七天选题智能体',      // 显示名称
    description: '简短描述',    // 卡片描述
    fullDescription: '完整说明', // 详细介绍
    inputGuide: '输入要求'      // 使用指南
}
```

## 🌐 端口占用

- **后端服务**：3000端口
- **前端页面**：8080端口（或Live Server随机端口）

## 📝 API通信格式

### 请求格式
```json
{
  "choice": 1,
  "userInput": "用户输入的内容"
}
```

### 响应格式
```json
{
  "success": true,
  "data": {
    "output": "生成的Markdown内容",
    "raw": {...}
  },
  "message": "工作流执行成功"
}
```

## 🔐 环境变量说明

| 变量名 | 说明 | 必填 | 示例 |
|--------|------|------|------|
| COZE_TOKEN | 扣子API Token | ✅ | pat_xxx |
| COZE_WORKFLOW_ID | 工作流ID | ✅ | 7599232922009583626 |
| PORT | 后端服务端口 | ❌ | 3000 |
| NODE_ENV | 运行环境 | ❌ | development/production |
| CORS_ORIGIN | 允许的前端地址 | ❌ | http://localhost:8080 |

## 🎯 智能体分类

### 1. 短视频获客矩阵（28个，ID: 1-23, 32-36）
- 选题生成
- 文案创作
- 口播脚本
- 直播策划

### 2. 客户培育与信任构建（3个，ID: 24-26）
- 朋友圈运营
- 社群互动
- 公众号内容

### 3. 成交与裂变转化（2个，ID: 27-28）
- 直播话术
- 跟单话术

### 4. 线下活动与招商赋能（3个，ID: 29-31）
- 招商演讲
- 流程策划
- 群内互动

## 🛠️ 开发命令

### 后端命令

```bash
# 开发模式（支持热重载）
npm run dev

# 构建项目
npm run build

# 生产模式运行
npm start

# 监听编译（自动编译TypeScript）
npm run watch
```

### 前端命令

```bash
# 使用Python启动
python -m http.server 8080

# 使用http-server（需全局安装）
http-server -p 8080
```

## 📈 性能优化建议

1. **后端**：
   - 使用PM2管理进程
   - 启用gzip压缩
   - 添加Redis缓存
   - 实现请求限流

2. **前端**：
   - 使用CDN加速静态资源
   - 实现代码分割
   - 添加Service Worker
   - 优化图片加载

## 🔍 调试技巧

### 后端调试

1. **查看控制台输出**
   - 每个请求都有详细日志
   - 显示API调用参数和响应

2. **查看日志文件**
   ```bash
   # Windows
   type logs\info.log
   type logs\error.log
   
   # Mac/Linux
   cat logs/info.log
   cat logs/error.log
   ```

3. **使用调试工具**
   - VS Code断点调试
   - Postman测试API
   - curl命令行测试

### 前端调试

1. **浏览器开发者工具**
   - Console标签：查看日志
   - Network标签：查看API请求
   - Application标签：查看存储

2. **Console日志**
   - 所有API调用都有console.log
   - 显示请求参数和响应数据

## 📦 部署建议

### 开发环境
- 使用npm run dev启动
- 启用详细日志
- 使用Live Server调试前端

### 生产环境
- 使用PM2管理后端进程
- Nginx托管前端静态文件
- 配置反向代理
- 启用HTTPS
- 设置环境变量而非.env文件

## 🎓 学习路径

1. **新手入门**
   - 阅读快速启动指南
   - 运行示例
   - 测试基础功能

2. **深入理解**
   - 阅读完整建设指南
   - 研究代码结构
   - 理解API调用流程

3. **高级定制**
   - 添加新智能体
   - 修改样式
   - 扩展功能

## 🆘 问题排查

### 常见错误及解决方案

| 错误 | 原因 | 解决方案 |
|------|------|----------|
| Cannot find module | 依赖未安装 | npm install |
| CORS error | 跨域配置错误 | 检查CORS_ORIGIN |
| Token invalid | Token过期或错误 | 更新.env中的Token |
| 响应为空 | API返回格式异常 | 查看后端日志 |
| 端口占用 | 端口被其他程序使用 | 修改PORT或关闭占用程序 |

---

**完整、可运行、易理解的项目结构！** 🎉
